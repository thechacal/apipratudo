version: "3.8"

services:
  quota-service:
    build:
      context: ./services/quota-service
    ports:
      - "8081:8081"
    environment:
      SPRING_PROFILES_ACTIVE: local
      PORT: 8081

  webhook-service:
    build:
      context: ./services/webhook-service
    ports:
      - "8082:8082"
    environment:
      SPRING_PROFILES_ACTIVE: local
      PORT: 8082
      WEBHOOK_SERVICE_TOKEN: dev-service-token

  api-gateway:
    build:
      context: ./services/api-gateway
    ports:
      - "8080:8080"
    depends_on:
      - quota-service
      - webhook-service
    environment:
      SPRING_PROFILES_ACTIVE: local
      PORT: 8080
      QUOTA_BASE_URL: http://quota-service:8081
      WEBHOOK_BASE_URL: http://webhook-service:8082
      QUOTA_INTERNAL_TOKEN: dev-internal
      WEBHOOK_SERVICE_TOKEN: dev-service-token
