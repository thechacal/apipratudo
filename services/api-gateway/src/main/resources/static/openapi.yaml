openapi: 3.0.3
info:
  title: apipratudo API Gateway
  version: 0.2.0
  description: API Gateway como front door para rotas /v1 do apipratudo.
servers:
  - url: https://api.apipratudo.local
security:
  - ApiKeyAuth: []
tags:
  - name: gateway
    description: Health e informacoes basicas do gateway /v1.
  - name: keys
    description: Chaves, status e upgrade por creditos.
  - name: loterias
    description: Resultados oficiais das loterias em /v1.
  - name: billing-saas
    description: Cobranca PIX/recorrencia, clientes e relatorios.
  - name: agendamento
    description: Agenda, servicos e reservas para agendamento.
  - name: helpdesk
    description: WhatsApp/atendimento, tickets e templates com SLA simples.
  - name: webhooks
    description: Cadastro e teste de webhooks do produto.
  - name: deliveries
    description: Entregas e reentregas de webhooks.
paths:
  /v1/echo:
    get:
      summary: Health echo do gateway
      description: Endpoint simples de verificacao do servico.
      tags:
        - gateway
      security: []
      responses:
        "200":
          description: Echo OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EchoResponse"
              examples:
                ok:
                  value:
                    service: api-gateway
                    status: ok
  /v1/keys/request:
    post:
      summary: Solicitar API key FREE
      description: "Solicita uma API key gratuita (plano FREE). Este endpoint e publico e nao requer autenticacao. Use este passo para testar a API gratuitamente. Em caso de indisponibilidade temporaria, a API retornara 503."
      tags:
        - keys
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/KeyRequest"
      responses:
        "201":
          description: API key criada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/KeyRequestResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "429":
          description: Limite de solicitacoes excedido
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "503":
          description: Servico temporariamente indisponivel
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              examples:
                unavailable:
                  value:
                    error: PORTAL_UNAVAILABLE
                    message: Servico de criacao de chaves temporariamente indisponivel
                    traceId: "7ae7227c333ebc2cbf8bfaf0dfb46f33"
  /v1/keys/status:
    get:
      summary: Status da API key
      tags:
        - keys
      security:
        - ApiKeyAuth: []
      responses:
        "200":
          description: Status atual
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QuotaStatusResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: API key nao encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/keys/upgrade:
    post:
      summary: Gerar cobranca PIX de pacotes de creditos
      description: "Compra pacotes de creditos (sem assinatura recorrente). Enquanto credits.remaining > 0, usa limites PREMIUM. Ao zerar, volta para FREE."
      tags:
        - keys
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/KeyUpgradeRequest"
      responses:
        "201":
          description: Cobranca criada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BillingChargeResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/keys/upgrade/{chargeId}:
    get:
      summary: Status da cobranca PIX
      tags:
        - keys
      security:
        - ApiKeyAuth: []
      parameters:
        - name: chargeId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Status da cobranca
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BillingChargeStatusResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Cobranca nao encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/clientes:
    post:
      summary: Criar cliente
      tags:
        - billing-saas
      security:
        - ApiKeyAuth: []
      parameters:
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 201.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CustomerCreateRequest"
      responses:
        "201":
          description: Cliente criado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CustomerResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/clientes/{id}:
    get:
      summary: Obter cliente
      tags:
        - billing-saas
      security:
        - ApiKeyAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Cliente encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CustomerResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Cliente nao encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/cobrancas:
    post:
      summary: Criar cobranca
      tags:
        - billing-saas
      security:
        - ApiKeyAuth: []
      parameters:
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 201.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChargeCreateRequest"
      responses:
        "201":
          description: Cobranca criada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChargeResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Cliente nao encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/cobrancas/{id}:
    get:
      summary: Obter cobranca
      tags:
        - billing-saas
      security:
        - ApiKeyAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Cobranca encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChargeResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Cobranca nao encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/cobrancas/{id}/status:
    get:
      summary: Status da cobranca
      tags:
        - billing-saas
      security:
        - ApiKeyAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Status da cobranca
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChargeStatusResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Cobranca nao encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/pix/gerar:
    post:
      summary: Gerar PIX para cobranca
      tags:
        - billing-saas
      security:
        - ApiKeyAuth: []
      parameters:
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 200.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PixGenerateRequest"
      responses:
        "200":
          description: PIX gerado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PixGenerateResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Cobranca nao encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/provedores/pagbank/conectar:
    post:
      summary: Conectar PagBank (Modelo B)
      description: Conecta o PagBank do tenant. Nao consome quota, mas exige X-Api-Key.
      tags:
        - billing-saas
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PagbankConnectRequest"
      responses:
        "200":
          description: Conexao registrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagbankStatusResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/provedores/pagbank/status:
    get:
      summary: Status da conexao PagBank
      description: Retorna se o PagBank esta conectado. Nao consome quota, mas exige X-Api-Key.
      tags:
        - billing-saas
      security:
        - ApiKeyAuth: []
      responses:
        "200":
          description: Status atual da conexao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagbankStatusResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/provedores/pagbank/desconectar:
    delete:
      summary: Desconectar PagBank
      description: Remove a conexao do PagBank. Nao consome quota, mas exige X-Api-Key.
      tags:
        - billing-saas
      security:
        - ApiKeyAuth: []
      responses:
        "204":
          description: Conexao removida
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/pix/webhook:
    post:
      summary: Webhook PIX
      description: Webhook do provedor PIX. Nao exige X-Api-Key; validado por segredo do webhook. Aceita payload FAKE e PagBank.
      tags:
        - billing-saas
      security: []
      parameters:
        - name: X-Webhook-Secret
          in: header
          required: true
          schema:
            type: string
        - name: X-Authenticity-Token
          in: header
          required: false
          description: Assinatura PagBank (quando usar payload PagBank).
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PixWebhookRequest"
      responses:
        "200":
          description: Webhook processado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PixWebhookResponse"
        "401":
          description: Webhook nao autorizado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Cobranca nao encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/relatorios:
    get:
      summary: Relatorio de cobrancas
      tags:
        - billing-saas
      security:
        - ApiKeyAuth: []
      parameters:
        - name: from
          in: query
          required: false
          schema:
            type: string
            format: date
        - name: to
          in: query
          required: false
          schema:
            type: string
            format: date
      responses:
        "200":
          description: Resumo de cobrancas
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ReportSummaryResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/servicos:
    get:
      summary: Listar servicos cadastrados
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      responses:
        "200":
          description: Lista de servicos
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ServiceResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/agendas:
    get:
      summary: Listar agendas cadastradas
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      responses:
        "200":
          description: Lista de agendas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/AgendaInfoResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Criar agenda
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 200.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AgendaCreateRequest"
      responses:
        "200":
          description: Agenda criada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgendaInfoResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Conflito de idempotencia
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/agendas/{id}:
    get:
      summary: Consultar agenda
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Agenda retornada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgendaInfoResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Agenda nao encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    patch:
      summary: Atualizar agenda
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 200.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AgendaUpdateRequest"
      responses:
        "200":
          description: Agenda atualizada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgendaInfoResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Conflito de idempotencia
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/agendas/{id}/creditos/upgrade:
    post:
      summary: Recarregar creditos da agenda
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 200.
          schema:
            type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AgendaCreditsUpgradeRequest"
      responses:
        "200":
          description: Cobranca gerada para recarga de creditos
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgendaCreditsUpgradeResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/agendas/{id}/creditos/status/{chargeId}:
    get:
      summary: Consultar status da recarga de creditos
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
        - name: chargeId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Status da cobranca
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgendaCreditsStatusResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Cobranca nao encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Criar servico de atendimento
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 200.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ServiceCreateRequest"
      responses:
        "200":
          description: Servico criado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ServiceResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Conflito de idempotencia
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/agenda:
    get:
      summary: Consultar agenda por periodo
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: from
          in: query
          required: true
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          required: true
          schema:
            type: string
            format: date-time
        - name: agendaId
          in: query
          required: false
          schema:
            type: string
            default: main
      responses:
        "200":
          description: Agenda retornada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgendaResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/slots-disponiveis:
    get:
      summary: Listar slots disponiveis por dia
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: serviceId
          in: query
          required: true
          schema:
            type: string
        - name: date
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: agendaId
          in: query
          required: false
          schema:
            type: string
            default: main
        - name: zoneId
          in: query
          required: false
          schema:
            type: string
      responses:
        "200":
          description: Slots disponiveis
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SlotsResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/reservar:
    post:
      summary: Reservar horario
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 200.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ReservationRequest"
      responses:
        "200":
          description: Reserva criada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ReservationResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Slot indisponivel
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/confirmar:
    post:
      summary: Confirmar reserva
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 200.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ConfirmRequest"
      responses:
        "200":
          description: Reserva confirmada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ConfirmResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Reserva expirada ou indisponivel
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/atendido:
    post:
      summary: Marcar atendimento como concluido
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 200.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AttendedRequest"
      responses:
        "200":
          description: Atendimento concluido
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AttendedResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Conflito de idempotencia
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/cancelar:
    post:
      summary: Cancelar reserva
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 200.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CancelRequest"
      responses:
        "200":
          description: Reserva cancelada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CancelResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Conflito de idempotencia
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/notificar:
    post:
      summary: Registrar notificacao
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 200.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NotifyRequest"
      responses:
        "200":
          description: Notificacao registrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotifyResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Conflito de idempotencia
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/multas:
    get:
      summary: Listar multas de no-show
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: agendaId
          in: query
          required: false
          schema:
            type: string
        - name: status
          in: query
          required: false
          schema:
            type: string
            example: PENDING
      responses:
        "200":
          description: Lista de multas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/FineResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/multas/{id}/waive:
    post:
      summary: Perdoar multa
      tags:
        - agendamento
      security:
        - ApiKeyAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 200.
          schema:
            type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/FineWaiveRequest"
      responses:
        "200":
          description: Multa perdoada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FineResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Multa nao encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/tickets:
    get:
      summary: Listar tickets de atendimento
      tags:
        - helpdesk
      security:
        - ApiKeyAuth: []
      parameters:
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum: [OPEN, PENDING, RESOLVED, CLOSED]
      responses:
        "200":
          description: Lista de tickets
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/TicketResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QuotaExceededResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Criar ticket de atendimento
      tags:
        - helpdesk
      security:
        - ApiKeyAuth: []
      parameters:
        - name: Idempotency-Key
          in: header
          required: false
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TicketCreateRequest"
      responses:
        "200":
          description: Ticket criado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TicketResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QuotaExceededResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/tickets/{ticketId}:
    get:
      summary: Consultar ticket
      tags:
        - helpdesk
      security:
        - ApiKeyAuth: []
      parameters:
        - name: ticketId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Ticket encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TicketResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QuotaExceededResponse"
        "404":
          description: Ticket nao encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/tickets/{ticketId}/mensagens:
    get:
      summary: Listar mensagens do ticket
      tags:
        - helpdesk
      security:
        - ApiKeyAuth: []
      parameters:
        - name: ticketId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Lista de mensagens
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/MessageResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QuotaExceededResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Enviar mensagem no ticket
      tags:
        - helpdesk
      security:
        - ApiKeyAuth: []
      parameters:
        - name: ticketId
          in: path
          required: true
          schema:
            type: string
        - name: Idempotency-Key
          in: header
          required: false
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MessageCreateRequest"
      responses:
        "200":
          description: Mensagem criada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessageResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QuotaExceededResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/tickets/{ticketId}/atribuir:
    post:
      summary: Atribuir ticket para agente
      tags:
        - helpdesk
      security:
        - ApiKeyAuth: []
      parameters:
        - name: ticketId
          in: path
          required: true
          schema:
            type: string
        - name: Idempotency-Key
          in: header
          required: false
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AssignRequest"
      responses:
        "200":
          description: Ticket atribuido
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TicketResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QuotaExceededResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/tickets/{ticketId}/status:
    post:
      summary: Atualizar status do ticket
      tags:
        - helpdesk
      security:
        - ApiKeyAuth: []
      parameters:
        - name: ticketId
          in: path
          required: true
          schema:
            type: string
        - name: Idempotency-Key
          in: header
          required: false
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StatusUpdateRequest"
      responses:
        "200":
          description: Ticket atualizado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TicketResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QuotaExceededResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/templates:
    get:
      summary: Listar templates de atendimento
      tags:
        - helpdesk
      security:
        - ApiKeyAuth: []
      responses:
        "200":
          description: Lista de templates
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/TemplateResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QuotaExceededResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Criar template de atendimento
      tags:
        - helpdesk
      security:
        - ApiKeyAuth: []
      parameters:
        - name: Idempotency-Key
          in: header
          required: false
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TemplateCreateRequest"
      responses:
        "200":
          description: Template criado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TemplateResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: API key invalida
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "402":
          description: Cota esgotada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QuotaExceededResponse"
        "500":
          description: Erro interno
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/webhook/whatsapp:
    get:
      summary: Verificacao do webhook do WhatsApp
      tags:
        - helpdesk
      security: []
      parameters:
        - name: hub.mode
          in: query
          required: false
          schema:
            type: string
        - name: hub.verify_token
          in: query
          required: false
          schema:
            type: string
        - name: hub.challenge
          in: query
          required: false
          schema:
            type: string
      responses:
        "200":
          description: Challenge validado
          content:
            text/plain:
              schema:
                type: string
        "403":
          description: Token invalido
    post:
      summary: Receber eventos do WhatsApp
      tags:
        - helpdesk
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          description: Evento recebido
          content:
            application/json:
              schema:
                type: object
        "401":
          description: Assinatura invalida
  /v1/webhooks:
    post:
      summary: Cadastro de webhook
      description: Cria um webhook no sistema.
      tags:
        - webhooks
      parameters:
        - name: Idempotency-Key
          in: header
          required: false
          description: Chave para idempotencia. Mesmo payload retorna a mesma resposta 201.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/WebhookCreateRequest"
      responses:
        "201":
          description: Webhook criado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WebhookCreateResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Conflito de idempotencia
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    get:
      summary: Listar webhooks
      tags:
        - webhooks
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: size
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 20
      responses:
        "200":
          description: Lista de webhooks
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WebhookListResponse"
  /v1/webhooks/{id}:
    get:
      summary: Obter webhook por id
      tags:
        - webhooks
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Webhook encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WebhookResponse"
        "404":
          description: Webhook nao encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    patch:
      summary: Atualizar webhook
      tags:
        - webhooks
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/WebhookUpdateRequest"
      responses:
        "200":
          description: Webhook atualizado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WebhookResponse"
        "400":
          description: Erro de validacao
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Webhook nao encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Remover webhook
      tags:
        - webhooks
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "204":
          description: Webhook removido
        "404":
          description: Webhook nao encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/webhooks/{id}/test:
    post:
      summary: Testar webhook
      tags:
        - webhooks
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "201":
          description: Entrega de teste criada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeliveryTestResponse"
        "404":
          description: Webhook nao encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/deliveries:
    get:
      summary: Listar deliveries
      tags:
        - deliveries
      parameters:
        - name: webhookId
          in: query
          required: false
          schema:
            type: string
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: size
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 20
      responses:
        "200":
          description: Lista de deliveries
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeliveryListResponse"
  /v1/deliveries/{id}:
    get:
      summary: Obter delivery por id
      tags:
        - deliveries
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Delivery encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeliveryResponse"
        "404":
          description: Delivery nao encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/deliveries/{id}/retry:
    post:
      summary: Reenviar delivery
      tags:
        - deliveries
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "201":
          description: Nova delivery criada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeliveryResponse"
        "404":
          description: Delivery nao encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/federal/resultado-oficial:
    get:
      summary: Resultado oficial Loteria Federal
      tags:
        - loterias
      responses:
        "200":
          description: Resultado oficial da Loteria Federal
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FederalResultadoOficialResponse"
        "502":
          description: Falha ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "504":
          description: Timeout ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/lotofacil/resultado-oficial:
    get:
      summary: Resultado oficial Lotofacil
      tags:
        - loterias
      responses:
        "200":
          description: Resultado oficial da Lotofacil
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LotofacilResultadoOficialResponse"
        "502":
          description: Falha ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "504":
          description: Timeout ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/megasena/resultado-oficial:
    get:
      summary: Resultado oficial Mega-Sena
      tags:
        - loterias
      responses:
        "200":
          description: Resultado oficial da Mega-Sena
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MegasenaResultadoOficialResponse"
        "502":
          description: Falha ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "504":
          description: Timeout ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/quina/resultado-oficial:
    get:
      summary: Resultado oficial Quina
      tags:
        - loterias
      responses:
        "200":
          description: Resultado oficial da Quina
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/QuinaResultadoOficialResponse"
        "502":
          description: Falha ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "504":
          description: Timeout ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/lotomania/resultado-oficial:
    get:
      summary: Resultado oficial Lotomania
      tags:
        - loterias
      responses:
        "200":
          description: Resultado oficial da Lotomania
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LotomaniaResultadoOficialResponse"
        "502":
          description: Falha ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "504":
          description: Timeout ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/timemania/resultado-oficial:
    get:
      summary: Resultado oficial Timemania
      tags:
        - loterias
      responses:
        "200":
          description: Resultado oficial da Timemania
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TimemaniaResultadoOficialResponse"
        "502":
          description: Falha ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "504":
          description: Timeout ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/duplasena/resultado-oficial:
    get:
      summary: Resultado oficial Dupla Sena
      tags:
        - loterias
      responses:
        "200":
          description: Resultado oficial da Dupla Sena
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DuplasenaResultadoOficialResponse"
        "502":
          description: Falha ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "504":
          description: Timeout ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/loteca/resultado-oficial:
    get:
      summary: Resultado oficial Loteca
      tags:
        - loterias
      responses:
        "200":
          description: Resultado oficial da Loteca
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LotecaResultadoOficialResponse"
        "502":
          description: Falha ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "504":
          description: Timeout ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/diadesorte/resultado-oficial:
    get:
      summary: Resultado oficial Dia de Sorte
      tags:
        - loterias
      responses:
        "200":
          description: Resultado oficial do Dia de Sorte
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DiadesorteResultadoOficialResponse"
        "502":
          description: Falha ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "504":
          description: Timeout ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/supersete/resultado-oficial:
    get:
      summary: Resultado oficial Super Sete
      tags:
        - loterias
      responses:
        "200":
          description: Resultado oficial do Super Sete
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuperseteResultadoOficialResponse"
        "502":
          description: Falha ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "504":
          description: Timeout ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /v1/maismilionaria/resultado-oficial:
    get:
      summary: Resultado oficial Mais Milionaria
      tags:
        - loterias
      responses:
        "200":
          description: Resultado oficial da Mais Milionaria
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MaismilionariaResultadoOficialResponse"
        "502":
          description: Falha ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "504":
          description: Timeout ao consultar resultado oficial da CAIXA
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-Api-Key
  schemas:
    EchoResponse:
      type: object
      required:
        - service
        - status
      properties:
        service:
          type: string
          example: api-gateway
        status:
          type: string
          example: ok
    WebhookStatus:
      type: string
      enum:
        - ACTIVE
        - DISABLED
        - DELETED
    WebhookUpdateStatus:
      type: string
      enum:
        - ACTIVE
        - DISABLED
    WebhookCreateRequest:
      type: object
      required:
        - targetUrl
        - eventType
      properties:
        targetUrl:
          type: string
          format: uri
          description: URL destino para recebimento do webhook.
          example: https://cliente.exemplo.com/webhooks/apipratudo
        eventType:
          type: string
          description: Tipo de evento que dispara o webhook.
          example: invoice.paid
    WebhookUpdateRequest:
      type: object
      properties:
        targetUrl:
          type: string
          format: uri
        eventType:
          type: string
        status:
          $ref: "#/components/schemas/WebhookUpdateStatus"
    WebhookCreateResponse:
      type: object
      required:
        - id
        - status
      properties:
        id:
          type: string
          format: uuid
          description: Identificador do webhook criado.
        status:
          $ref: "#/components/schemas/WebhookStatus"
    WebhookResponse:
      type: object
      required:
        - id
        - targetUrl
        - eventType
        - status
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
        targetUrl:
          type: string
          format: uri
        eventType:
          type: string
        status:
          $ref: "#/components/schemas/WebhookStatus"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    WebhookListResponse:
      type: object
      required:
        - items
        - page
        - size
        - total
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/WebhookResponse"
        page:
          type: integer
        size:
          type: integer
        total:
          type: integer
          format: int64
    DeliveryStatus:
      type: string
      enum:
        - PENDING
        - SUCCESS
        - FAILED
    DeliveryResponse:
      type: object
      required:
        - id
        - webhookId
        - eventType
        - targetUrl
        - status
        - attempt
        - responseCode
        - createdAt
      properties:
        id:
          type: string
          format: uuid
        webhookId:
          type: string
          format: uuid
        eventType:
          type: string
        targetUrl:
          type: string
          format: uri
        status:
          $ref: "#/components/schemas/DeliveryStatus"
        attempt:
          type: integer
          example: 1
        responseCode:
          type: integer
          example: 200
        createdAt:
          type: string
          format: date-time
    DeliveryListResponse:
      type: object
      required:
        - items
        - page
        - size
        - total
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/DeliveryResponse"
        page:
          type: integer
        size:
          type: integer
        total:
          type: integer
          format: int64
    DeliveryTestResponse:
      type: object
      required:
        - deliveryId
        - status
      properties:
        deliveryId:
          type: string
          format: uuid
        status:
          $ref: "#/components/schemas/DeliveryStatus"
    ErrorResponse:
      type: object
      required:
        - error
        - message
        - details
      properties:
        error:
          type: string
          example: VALIDATION_ERROR
        message:
          type: string
          example: Validation error
        details:
          type: array
          items:
            type: string
          example:
            - targetUrl must not be blank
        traceId:
          type: string
          example: 4bf92f3577b34da6a3ce929d0e0e4736
    Plan:
      type: string
      enum:
        - FREE
        - PREMIUM
    ApiKeyLimits:
      type: object
      required:
        - requestsPerMinute
        - requestsPerDay
      properties:
        requestsPerMinute:
          type: integer
          minimum: 1
        requestsPerDay:
          type: integer
          minimum: 1
    ApiKeyCredits:
      type: object
      required:
        - remaining
      properties:
        remaining:
          type: integer
          format: int64
    QuotaWindowStatus:
      type: object
      required:
        - limit
        - used
        - remaining
        - resetAt
      properties:
        limit:
          type: integer
          format: int64
        used:
          type: integer
          format: int64
        remaining:
          type: integer
          format: int64
        resetAt:
          type: string
          format: date-time
    QuotaUsage:
      type: object
      required:
        - minute
        - day
      properties:
        minute:
          $ref: "#/components/schemas/QuotaWindowStatus"
        day:
          $ref: "#/components/schemas/QuotaWindowStatus"
    QuotaStatusResponse:
      type: object
      required:
        - apiKeyId
        - plan
        - limits
        - usage
        - credits
      properties:
        apiKeyId:
          type: string
        plan:
          $ref: "#/components/schemas/Plan"
        limits:
          $ref: "#/components/schemas/ApiKeyLimits"
        usage:
          $ref: "#/components/schemas/QuotaUsage"
        credits:
          $ref: "#/components/schemas/ApiKeyCredits"
    KeyRequest:
      type: object
      required:
        - email
        - org
      properties:
        email:
          type: string
          format: email
        org:
          type: string
        useCase:
          type: string
    KeyRequestResponse:
      type: object
      required:
        - apiKey
        - plan
        - limits
        - credits
        - docsUrl
        - gatewayUrl
      properties:
        apiKey:
          type: string
        plan:
          $ref: "#/components/schemas/Plan"
        limits:
          $ref: "#/components/schemas/ApiKeyLimits"
        credits:
          $ref: "#/components/schemas/ApiKeyCredits"
        docsUrl:
          type: string
        gatewayUrl:
          type: string
    KeyUpgradeRequest:
      type: object
      properties:
        packageName:
          type: string
          example: START
          enum:
            - START
            - PRO
            - SCALE
    BillingChargeResponse:
      type: object
      required:
        - chargeId
        - status
        - pixCopyPaste
      properties:
        chargeId:
          type: string
        status:
          type: string
        amountCents:
          type: integer
        amount:
          type: string
        creditsAdded:
          type: integer
          format: int64
        creditsBalanceAfter:
          type: integer
          format: int64
        packageName:
          type: string
        expiresAt:
          type: string
        pixCopyPaste:
          type: string
        qrCodeBase64:
          type: string
    BillingChargeStatusResponse:
      type: object
      required:
        - chargeId
        - status
        - paid
      properties:
        chargeId:
          type: string
        status:
          type: string
        paid:
          type: boolean
        packageName:
          type: string
        creditsAdded:
          type: integer
          format: int64
        creditsBalanceAfter:
          type: integer
          format: int64
        creditsApplied:
          type: boolean
    FederalPremio:
      type: object
      required:
        - destino
        - bilhete
        - unidadeLoterica
        - cidadeUf
        - valorPremio
      properties:
        destino:
          type: string
          example: "1"
        bilhete:
          type: string
          example: "12345"
        unidadeLoterica:
          type: string
          example: Lotrica Centro
        cidadeUf:
          type: string
          example: Sao Paulo/SP
        valorPremio:
          type: string
          example: R$ 500.000,00
    FederalResultadoOficialResponse:
      type: object
      required:
        - fonte
        - loteria
        - concurso
        - dataApuracao
        - premios
        - capturadoEm
      properties:
        fonte:
          type: string
          example: CAIXA
        loteria:
          type: string
          example: FEDERAL
        concurso:
          type: string
          example: "5970"
        dataApuracao:
          type: string
          format: date
          example: "2026-01-10"
        premios:
          type: array
          items:
            $ref: "#/components/schemas/FederalPremio"
        capturadoEm:
          type: string
          format: date-time
    LotofacilResultadoOficialResponse:
      type: object
      required:
        - fonte
        - loteria
        - concurso
        - dataApuracao
        - dezenas
        - capturadoEm
      properties:
        fonte:
          type: string
          example: CAIXA
        loteria:
          type: string
          example: LOTOFACIL
        concurso:
          type: string
          example: "3468"
        dataApuracao:
          type: string
          format: date
          example: "2025-08-13"
        dezenas:
          type: array
          items:
            type: string
            example: "01"
        capturadoEm:
          type: string
          format: date-time
    MegasenaResultadoOficialResponse:
      type: object
      required:
        - fonte
        - loteria
        - concurso
        - dataApuracao
        - dezenas
        - capturadoEm
      properties:
        fonte:
          type: string
          example: CAIXA
        loteria:
          type: string
          example: MEGA_SENA
        concurso:
          type: string
          example: "2760"
        dataApuracao:
          type: string
          format: date
          example: "2025-08-13"
        dezenas:
          type: array
          items:
            type: string
            example: "01"
        capturadoEm:
          type: string
          format: date-time
    QuinaResultadoOficialResponse:
      type: object
      required:
        - fonte
        - loteria
        - concurso
        - dataApuracao
        - dezenas
        - capturadoEm
      properties:
        fonte:
          type: string
          example: CAIXA
        loteria:
          type: string
          example: QUINA
        concurso:
          type: string
          example: "6500"
        dataApuracao:
          type: string
          format: date
          example: "2025-08-13"
        dezenas:
          type: array
          items:
            type: string
            example: "01"
        capturadoEm:
          type: string
          format: date-time
    LotomaniaResultadoOficialResponse:
      type: object
      required:
        - fonte
        - loteria
        - concurso
        - dataApuracao
        - dezenas
        - capturadoEm
      properties:
        fonte:
          type: string
          example: CAIXA
        loteria:
          type: string
          example: LOTOMANIA
        concurso:
          type: string
          example: "2600"
        dataApuracao:
          type: string
          format: date
          example: "2025-08-13"
        dezenas:
          type: array
          items:
            type: string
            example: "00"
        capturadoEm:
          type: string
          format: date-time
    TimemaniaResultadoOficialResponse:
      type: object
      required:
        - fonte
        - loteria
        - concurso
        - dataApuracao
        - dezenas
        - timeCoracao
        - capturadoEm
      properties:
        fonte:
          type: string
          example: CAIXA
        loteria:
          type: string
          example: TIMEMANIA
        concurso:
          type: string
          example: "2100"
        dataApuracao:
          type: string
          format: date
          example: "2025-08-13"
        dezenas:
          type: array
          items:
            type: string
            example: "01"
        timeCoracao:
          type: string
          example: "Time do Coracao"
        capturadoEm:
          type: string
          format: date-time
    DuplasenaResultadoOficialResponse:
      type: object
      required:
        - fonte
        - loteria
        - concurso
        - dataApuracao
        - sorteio1
        - sorteio2
        - capturadoEm
      properties:
        fonte:
          type: string
          example: CAIXA
        loteria:
          type: string
          example: DUPLASENA
        concurso:
          type: string
          example: "2600"
        dataApuracao:
          type: string
          format: date
          example: "2025-08-13"
        sorteio1:
          type: array
          items:
            type: string
            example: "01"
        sorteio2:
          type: array
          items:
            type: string
            example: "02"
        capturadoEm:
          type: string
          format: date-time
    LotecaJogo:
      type: object
      required:
        - jogo
        - time1
        - gols1
        - time2
        - gols2
      properties:
        jogo:
          type: integer
          example: 1
        time1:
          type: string
          example: TIME A
        gols1:
          type: string
          example: "0"
        time2:
          type: string
          example: TIME B
        gols2:
          type: string
          example: "0"
    LotecaResultadoOficialResponse:
      type: object
      required:
        - fonte
        - loteria
        - concurso
        - dataApuracao
        - jogos
        - capturadoEm
      properties:
        fonte:
          type: string
          example: CAIXA
        loteria:
          type: string
          example: LOTECA
        concurso:
          type: string
          example: "1150"
        dataApuracao:
          type: string
          format: date
          example: "2025-08-13"
        jogos:
          type: array
          items:
            $ref: "#/components/schemas/LotecaJogo"
        capturadoEm:
          type: string
          format: date-time
    DiadesorteResultadoOficialResponse:
      type: object
      required:
        - fonte
        - loteria
        - concurso
        - dataApuracao
        - dezenas
        - mesDaSorte
        - capturadoEm
      properties:
        fonte:
          type: string
          example: CAIXA
        loteria:
          type: string
          example: DIADESORTE
        concurso:
          type: string
          example: "1000"
        dataApuracao:
          type: string
          format: date
          example: "2025-08-13"
        dezenas:
          type: array
          items:
            type: string
            example: "01"
        mesDaSorte:
          type: string
          example: JANEIRO
        capturadoEm:
          type: string
          format: date-time
    SuperseteResultadoOficialResponse:
      type: object
      required:
        - fonte
        - loteria
        - concurso
        - dataApuracao
        - colunas
        - capturadoEm
      properties:
        fonte:
          type: string
          example: CAIXA
        loteria:
          type: string
          example: SUPERSETE
        concurso:
          type: string
          example: "400"
        dataApuracao:
          type: string
          format: date
          example: "2025-08-13"
        colunas:
          type: array
          items:
            type: string
            example: "0"
        capturadoEm:
          type: string
          format: date-time
    MaismilionariaResultadoOficialResponse:
      type: object
      required:
        - fonte
        - loteria
        - concurso
        - dataApuracao
        - dezenas
        - trevos
        - capturadoEm
      properties:
        fonte:
          type: string
          example: CAIXA
        loteria:
          type: string
          example: MAISMILIONARIA
        concurso:
          type: string
          example: "200"
        dataApuracao:
          type: string
          format: date
          example: "2025-08-13"
        dezenas:
          type: array
          items:
            type: string
            example: "01"
        trevos:
          type: array
          items:
            type: string
            example: "01"
        capturadoEm:
          type: string
          format: date-time
    ChargeStatus:
      type: string
      enum:
        - CREATED
        - PIX_GENERATED
        - PENDING
        - PAID
        - EXPIRED
        - CANCELED
    PagbankConnectRequest:
      type: object
      required:
        - token
      properties:
        token:
          type: string
          description: Token do PagBank do tenant.
        webhookToken:
          type: string
          description: Token de webhook do PagBank (opcional).
        environment:
          type: string
          enum:
            - SANDBOX
            - PRODUCTION
          example: SANDBOX
    PagbankStatusResponse:
      type: object
      required:
        - connected
      properties:
        connected:
          type: boolean
          example: true
        environment:
          type: string
          example: SANDBOX
        fingerprint:
          type: string
          example: deadbeef
        updatedAt:
          type: string
          format: date-time
    CustomerCreateRequest:
      type: object
      required:
        - name
        - document
        - email
        - phone
      properties:
        name:
          type: string
          example: Cliente ACME
        document:
          type: string
          example: "12345678900"
        email:
          type: string
          example: financeiro@acme.com
        phone:
          type: string
          example: "+5511999999999"
        externalId:
          type: string
          example: "erp-123"
        metadata:
          type: object
          additionalProperties:
            type: string
    CustomerResponse:
      type: object
      required:
        - id
        - name
        - document
        - email
        - phone
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          example: cus_123
        name:
          type: string
        document:
          type: string
        email:
          type: string
        phone:
          type: string
        externalId:
          type: string
        metadata:
          type: object
          additionalProperties:
            type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    RecurrenceRequest:
      type: object
      required:
        - frequency
      properties:
        frequency:
          type: string
          enum:
            - MONTHLY
        interval:
          type: integer
          minimum: 1
          example: 1
        dayOfMonth:
          type: integer
          minimum: 1
          maximum: 31
          example: 10
    ChargeCreateRequest:
      type: object
      required:
        - customerId
        - amountCents
        - dueDate
      properties:
        customerId:
          type: string
          example: cus_123
        amountCents:
          type: integer
          format: int64
          example: 1990
        currency:
          type: string
          example: BRL
        description:
          type: string
          example: Mensalidade
        dueDate:
          type: string
          format: date
          example: "2026-01-31"
        recurrence:
          $ref: "#/components/schemas/RecurrenceRequest"
        metadata:
          type: object
          additionalProperties:
            type: string
    ChargeResponse:
      type: object
      required:
        - id
        - customerId
        - amountCents
        - currency
        - dueDate
        - status
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          example: chg_123
        customerId:
          type: string
        amountCents:
          type: integer
          format: int64
        currency:
          type: string
        description:
          type: string
        dueDate:
          type: string
          format: date
        recurrence:
          $ref: "#/components/schemas/RecurrenceRequest"
        metadata:
          type: object
          additionalProperties:
            type: string
        status:
          $ref: "#/components/schemas/ChargeStatus"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        paidAt:
          type: string
          format: date-time
        pix:
          $ref: "#/components/schemas/PixDataResponse"
    ChargeStatusResponse:
      type: object
      required:
        - id
        - status
      properties:
        id:
          type: string
          example: chg_123
        status:
          $ref: "#/components/schemas/ChargeStatus"
        paidAt:
          type: string
          format: date-time
        pix:
          $ref: "#/components/schemas/PixDataResponse"
    PixGenerateRequest:
      type: object
      required:
        - chargeId
      properties:
        chargeId:
          type: string
          example: chg_123
        expiresInSeconds:
          type: integer
          minimum: 60
          example: 3600
    PixGenerateResponse:
      type: object
      required:
        - chargeId
        - status
        - pix
      properties:
        chargeId:
          type: string
        status:
          $ref: "#/components/schemas/ChargeStatus"
        pix:
          $ref: "#/components/schemas/PixDataResponse"
        whatsappLink:
          type: string
          format: uri
    PixWebhookRequest:
      type: object
      required:
        - provider
        - providerChargeId
        - event
      properties:
        provider:
          type: string
          example: FAKE
        providerChargeId:
          type: string
          example: fake_123
        event:
          type: string
          example: PAID
        paidAt:
          type: string
          format: date-time
    PixWebhookResponse:
      type: object
      required:
        - ok
      properties:
        ok:
          type: boolean
          example: true
    PixDataResponse:
      type: object
      required:
        - provider
        - providerChargeId
        - txid
        - pixCopyPaste
        - qrCodeBase64
        - expiresAt
      properties:
        provider:
          type: string
          example: FAKE
        providerChargeId:
          type: string
        txid:
          type: string
        pixCopyPaste:
          type: string
        qrCodeBase64:
          type: string
        expiresAt:
          type: string
          format: date-time
    ReportSummaryResponse:
      type: object
      required:
        - from
        - to
        - countTotal
        - countPaid
        - countPending
        - totalCents
        - paidCents
        - pendingCents
      properties:
        from:
          type: string
          format: date
        to:
          type: string
          format: date
        countTotal:
          type: integer
          format: int64
        countPaid:
          type: integer
          format: int64
        countPending:
          type: integer
          format: int64
        totalCents:
          type: integer
          format: int64
        paidCents:
          type: integer
          format: int64
        pendingCents:
          type: integer
          format: int64
    ServiceCreateRequest:
      type: object
      required:
        - name
        - durationMin
        - prepMin
        - bufferMin
        - noShowFeeCents
        - active
      properties:
        name:
          type: string
          example: Corte Masculino
        durationMin:
          type: integer
          example: 40
        prepMin:
          type: integer
          example: 5
        bufferMin:
          type: integer
          example: 10
        noShowFeeCents:
          type: integer
          format: int64
          example: 2000
        active:
          type: boolean
          example: true
    ServiceResponse:
      type: object
      required:
        - id
        - name
        - durationMin
        - prepMin
        - bufferMin
        - noShowFeeCents
        - active
        - createdAt
      properties:
        id:
          type: string
          example: srv_123
        name:
          type: string
        durationMin:
          type: integer
        prepMin:
          type: integer
        bufferMin:
          type: integer
        noShowFeeCents:
          type: integer
          format: int64
        active:
          type: boolean
        createdAt:
          type: string
          format: date-time
    CustomerRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          example: Ana
        phone:
          type: string
          example: "+5588999990000"
        email:
          type: string
          example: ana@email.com
    ReservationRequest:
      type: object
      required:
        - serviceId
        - agendaId
        - startAt
        - customer
      properties:
        serviceId:
          type: string
          example: srv_123
        agendaId:
          type: string
          example: main
        startAt:
          type: string
          format: date-time
          example: "2026-01-26T12:00:00Z"
        customer:
          $ref: "#/components/schemas/CustomerRequest"
        notes:
          type: string
          example: Preferencia por tesoura.
    ReservationResponse:
      type: object
      required:
        - appointmentId
        - status
        - holdExpiresAt
        - startAt
        - endAt
      properties:
        appointmentId:
          type: string
          example: apt_123
        status:
          type: string
          example: HELD
        holdExpiresAt:
          type: string
          format: date-time
        startAt:
          type: string
          format: date-time
        endAt:
          type: string
          format: date-time
    ConfirmRequest:
      type: object
      required:
        - appointmentId
      properties:
        appointmentId:
          type: string
          example: apt_123
    ConfirmResponse:
      type: object
      required:
        - appointmentId
        - status
      properties:
        appointmentId:
          type: string
        status:
          type: string
          example: CONFIRMED
    CancelRequest:
      type: object
      required:
        - appointmentId
      properties:
        appointmentId:
          type: string
          example: apt_123
        reason:
          type: string
          example: Cliente pediu remarcacao
    CancelResponse:
      type: object
      required:
        - appointmentId
        - status
        - cancellationFeeCents
      properties:
        appointmentId:
          type: string
        status:
          type: string
          example: CANCELLED
        cancellationFeeCents:
          type: integer
          format: int64
          example: 0
    NotifyRequest:
      type: object
      required:
        - appointmentId
        - type
      properties:
        appointmentId:
          type: string
          example: apt_123
        type:
          type: string
          example: REMINDER
    NotifyResponse:
      type: object
      required:
        - ok
        - appointmentId
        - type
      properties:
        ok:
          type: boolean
          example: true
        appointmentId:
          type: string
        type:
          type: string
    SlotResponse:
      type: object
      required:
        - startAt
        - endAt
      properties:
        startAt:
          type: string
          format: date-time
        endAt:
          type: string
          format: date-time
    SlotsResponse:
      type: object
      required:
        - serviceId
        - date
        - agendaId
        - slotStepMin
        - slots
      properties:
        serviceId:
          type: string
        date:
          type: string
          format: date
        agendaId:
          type: string
        slotStepMin:
          type: integer
        slots:
          type: array
          items:
            $ref: "#/components/schemas/SlotResponse"
    AppointmentResponse:
      type: object
      required:
        - appointmentId
        - serviceId
        - agendaId
        - status
        - startAt
        - endAt
      properties:
        appointmentId:
          type: string
        serviceId:
          type: string
        agendaId:
          type: string
        status:
          type: string
        startAt:
          type: string
          format: date-time
        endAt:
          type: string
          format: date-time
        holdExpiresAt:
          type: string
          format: date-time
        customer:
          $ref: "#/components/schemas/CustomerRequest"
        notes:
          type: string
    AgendaResponse:
      type: object
      required:
        - agendaId
        - from
        - to
        - appointments
      properties:
        agendaId:
          type: string
        from:
          type: string
          format: date-time
        to:
          type: string
          format: date-time
        appointments:
          type: array
          items:
            $ref: "#/components/schemas/AppointmentResponse"
    AgendaCreateRequest:
      type: object
      required:
        - name
        - timezone
        - workingHoursStart
        - workingHoursEnd
        - slotStepMin
        - noShowFeeCents
        - active
      properties:
        name:
          type: string
          example: Agenda Principal
        timezone:
          type: string
          example: America/Sao_Paulo
        workingHoursStart:
          type: string
          example: "08:00"
        workingHoursEnd:
          type: string
          example: "18:00"
        slotStepMin:
          type: integer
          example: 15
        noShowFeeCents:
          type: integer
          format: int64
          example: 2000
        active:
          type: boolean
          example: true
    AgendaUpdateRequest:
      type: object
      properties:
        name:
          type: string
        timezone:
          type: string
        workingHoursStart:
          type: string
        workingHoursEnd:
          type: string
        slotStepMin:
          type: integer
        noShowFeeCents:
          type: integer
          format: int64
        active:
          type: boolean
    AgendaInfoResponse:
      type: object
      required:
        - id
        - name
        - timezone
        - workingHoursStart
        - workingHoursEnd
        - slotStepMin
        - noShowFeeCents
        - active
        - createdAt
        - updatedAt
        - creditsRemaining
      properties:
        id:
          type: string
          example: agd_123
        name:
          type: string
        timezone:
          type: string
        workingHoursStart:
          type: string
        workingHoursEnd:
          type: string
        slotStepMin:
          type: integer
        noShowFeeCents:
          type: integer
          format: int64
        active:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        creditsRemaining:
          type: integer
          format: int64
    AgendaCreditsUpgradeRequest:
      type: object
      properties:
        packageName:
          type: string
          example: START
    AgendaCreditsUpgradeResponse:
      type: object
      required:
        - agendaId
        - chargeId
        - status
        - creditsAdded
        - creditsBalance
      properties:
        agendaId:
          type: string
        chargeId:
          type: string
        status:
          type: string
        creditsAdded:
          type: integer
          format: int64
        creditsBalance:
          type: integer
          format: int64
        providerChargeId:
          type: string
        pixCopyPaste:
          type: string
        expiresAt:
          type: string
          format: date-time
    AgendaCreditsStatusResponse:
      type: object
      required:
        - agendaId
        - status
        - creditsAdded
        - creditsBalance
      properties:
        agendaId:
          type: string
        chargeId:
          type: string
        status:
          type: string
        creditsAdded:
          type: integer
          format: int64
        creditsBalance:
          type: integer
          format: int64
    AttendedRequest:
      type: object
      required:
        - appointmentId
      properties:
        appointmentId:
          type: string
          example: apt_123
    AttendedResponse:
      type: object
      required:
        - appointmentId
        - status
      properties:
        appointmentId:
          type: string
        status:
          type: string
          example: ATTENDED
    FineResponse:
      type: object
      required:
        - id
        - agendaId
        - appointmentId
        - amountCents
        - status
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          example: fine_123
        agendaId:
          type: string
        appointmentId:
          type: string
        amountCents:
          type: integer
          format: int64
        status:
          type: string
          example: PENDING
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    FineWaiveRequest:
      type: object
      properties:
        reason:
          type: string
          example: Cliente isento
    TicketCreateRequest:
      type: object
      required:
        - customerWaId
      properties:
        customerWaId:
          type: string
          example: 5588999990000
    TicketResponse:
      type: object
      required:
        - id
        - status
        - customerWaId
        - createdAt
        - updatedAt
        - slaFirstResponseDueAt
      properties:
        id:
          type: string
          example: tkt_123
        status:
          type: string
          example: OPEN
        assigneeUserId:
          type: string
          nullable: true
        customerWaId:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        slaFirstResponseDueAt:
          type: string
          format: date-time
        firstResponseAt:
          type: string
          format: date-time
          nullable: true
        autoSummary:
          type: string
        intentTags:
          type: array
          items:
            type: string
    MessageCreateRequest:
      type: object
      required:
        - direction
        - text
      properties:
        direction:
          type: string
          enum: [INBOUND, OUTBOUND]
        text:
          type: string
        providerMessageId:
          type: string
          nullable: true
    MessageResponse:
      type: object
      required:
        - id
        - ticketId
        - direction
        - text
        - createdAt
      properties:
        id:
          type: string
        ticketId:
          type: string
        direction:
          type: string
          enum: [INBOUND, OUTBOUND]
        text:
          type: string
        createdAt:
          type: string
          format: date-time
        providerMessageId:
          type: string
          nullable: true
    AssignRequest:
      type: object
      required:
        - assigneeUserId
      properties:
        assigneeUserId:
          type: string
    StatusUpdateRequest:
      type: object
      required:
        - status
      properties:
        status:
          type: string
          enum: [OPEN, PENDING, RESOLVED, CLOSED]
    TemplateCreateRequest:
      type: object
      required:
        - name
        - body
      properties:
        name:
          type: string
        body:
          type: string
    TemplateResponse:
      type: object
      required:
        - id
        - name
        - body
        - createdAt
      properties:
        id:
          type: string
        name:
          type: string
        body:
          type: string
        createdAt:
          type: string
          format: date-time
    QuotaExceededResponse:
      type: object
      required:
        - error
        - message
        - upgrade
      properties:
        error:
          type: string
          example: QUOTA_EXCEEDED
        message:
          type: string
          example: Cota esgotada. Recarregue creditos para continuar.
        upgrade:
          type: object
          required:
            - endpoint
            - docs
          properties:
            endpoint:
              type: string
              example: /v1/keys/upgrade
            docs:
              type: string
              example: /docs
